<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign in â€” Smart Exam Cell</title>
  <style>
    :root{--bg:#0b1220;--card:#0f1724;--accent1:#7c3aed;--accent2:#06b6d4}
    html,body{height:100%;margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#030615, #0b1220);color:#e6eef8}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:100%;max-width:920px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));border-radius:14px;padding:28px;display:grid;grid-template-columns:1fr 420px;gap:24px;box-shadow:0 30px 80px rgba(2,6,23,0.6)}
    .brand{padding:18px}
    .brand h1{font-size:28px;margin:6px 0 0 0;color:linear-gradient(90deg,var(--accent2),var(--accent1))}
    .brand p{color:#9fb3d6}
    .form{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px}
    label{display:block;margin-bottom:8px;color:#9fb3d6;font-weight:600}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e6eef8;margin-bottom:12px}
    .btn{display:inline-block;padding:12px 16px;border-radius:10px;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:white;border:none;font-weight:800;cursor:pointer}
    .small{font-size:13px;color:#9fb3d6;margin-top:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">
        <img src="/static/kct-logo.svg" alt="logo" style="height:56px">
        <h1>Smart Exam Cell</h1>
        <p>Sign in to manage students, faculty and exams.</p>
        <p class="small">Demo: admin@college.edu / admin123</p>
      </div>
      <div class="form">
        <form id="loginForm">
          <label>Email</label>
          <input id="email" type="email" value="admin@college.edu" required />
          <label>Password</label>
          <input id="password" type="password" value="admin123" required />
          <div style="display:flex;gap:8px;align-items:center;margin-top:12px">
            <button class="btn" type="submit">Sign in</button>
            <div style="color:#9fb3d6;font-size:13px">or use demo credentials</div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    const API = '/api';
    document.getElementById('loginForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try{
        const res = await fetch(`${API}/login`, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password})});
        if(!res.ok){alert('Invalid credentials');return}
        const data = await res.json();
        // store token and role if localStorage is available
        try{
          localStorage.setItem('authToken', data.token || '');
          localStorage.setItem('userRole', (data.user && data.user.role) || '');
        }catch(e){
          // ignore - we'll pass via query params instead
        }
        // redirect to dashboard; include token and role as fallback query params
        const token = encodeURIComponent(data.token || '');
        const role = encodeURIComponent((data.user && data.user.role) || '');
        window.location = `/dashboard${token ? ('?token=' + token + '&role=' + role) : ''}`;
      }catch(err){
        console.error(err);alert('Failed to connect to server.');
      }
    });
  </script>
</body>
</html>
